/*
Deployment script for Reference_John

This code was generated by a tool.
Changes to this file may cause incorrect behavior and will be lost if
the code is regenerated.
*/

GO
SET ANSI_NULLS, ANSI_PADDING, ANSI_WARNINGS, ARITHABORT, CONCAT_NULL_YIELDS_NULL, QUOTED_IDENTIFIER ON;

SET NUMERIC_ROUNDABORT OFF;


GO
:setvar DatabaseName "Reference_John"
:setvar DefaultFilePrefix "Reference_John"
:setvar DefaultDataPath "c:\Program Files\Microsoft SQL Server\MSSQL11.SQLEXPRESS\MSSQL\DATA\"
:setvar DefaultLogPath "c:\Program Files\Microsoft SQL Server\MSSQL11.SQLEXPRESS\MSSQL\DATA\"

GO
:on error exit
GO
/*
Detect SQLCMD mode and disable script execution if SQLCMD mode is not supported.
To re-enable the script after enabling SQLCMD mode, execute the following:
SET NOEXEC OFF; 
*/
:setvar __IsSqlCmdEnabled "True"
GO
IF N'$(__IsSqlCmdEnabled)' NOT LIKE N'True'
    BEGIN
        PRINT N'SQLCMD mode must be enabled to successfully execute this script.';
        SET NOEXEC ON;
    END


GO
USE [$(DatabaseName)];


GO
PRINT N'Creating [dbo].[Address]...';


GO
CREATE TABLE [dbo].[Address] (
    [Id]               INT           IDENTITY (1, 1) NOT NULL,
    [FormSimpleZeroId] INT           NOT NULL,
    [AddressLine1]     NVARCHAR (50) NOT NULL,
    [AddressLine2]     NVARCHAR (50) NULL,
    [AddressLine3]     NVARCHAR (50) NULL,
    [City]             NVARCHAR (50) NULL,
    [State]            NVARCHAR (50) NULL,
    [Zip]              NVARCHAR (50) NULL,
    [DateCreated]      DATETIME      NOT NULL,
    [LastChangeUser]   NVARCHAR (50) NOT NULL,
    [LastChangeDate]   DATETIME      NOT NULL,
    PRIMARY KEY CLUSTERED ([Id] ASC)
);


GO
PRINT N'Creating [dbo].[AddressOptionList]...';


GO
CREATE TABLE [dbo].[AddressOptionList] (
    [Id]             INT           IDENTITY (1, 1) NOT NULL,
    [Name]           NVARCHAR (50) NOT NULL,
    [SortOrder]      INT           NOT NULL,
    [IsActive]       INT           NOT NULL,
    [StartDate]      DATETIME      NOT NULL,
    [EndDate]        DATETIME      NULL,
    [LastChangeUser] NVARCHAR (50) NOT NULL,
    [LastChangeDate] DATETIME      NOT NULL,
    PRIMARY KEY CLUSTERED ([Id] ASC)
);


GO
PRINT N'Creating Default Constraint on [dbo].[AddressOptionList]....';


GO
ALTER TABLE [dbo].[AddressOptionList]
    ADD DEFAULT 1 FOR [SortOrder];


GO
PRINT N'Creating Default Constraint on [dbo].[AddressOptionList]....';


GO
ALTER TABLE [dbo].[AddressOptionList]
    ADD DEFAULT 1 FOR [IsActive];


GO
PRINT N'Creating FK_Address_FormSimpleZeroId...';


GO
ALTER TABLE [dbo].[Address] WITH NOCHECK
    ADD CONSTRAINT [FK_Address_FormSimpleZeroId] FOREIGN KEY ([FormSimpleZeroId]) REFERENCES [dbo].[FormSimpleZero] ([Id]);


GO
PRINT N'Creating [dbo].[AddressOptionList].[Id].[MS_Description]...';


GO
EXECUTE sp_addextendedproperty @name = N'MS_Description', @value = N'Primary Key for table', @level0type = N'SCHEMA', @level0name = N'dbo', @level1type = N'TABLE', @level1name = N'AddressOptionList', @level2type = N'COLUMN', @level2name = N'Id';


GO
PRINT N'Creating [dbo].[AddressOptionList].[Name].[MS_Description]...';


GO
EXECUTE sp_addextendedproperty @name = N'MS_Description', @value = N'Text value of the option list record.', @level0type = N'SCHEMA', @level0name = N'dbo', @level1type = N'TABLE', @level1name = N'AddressOptionList', @level2type = N'COLUMN', @level2name = N'Name';


GO
PRINT N'Creating [dbo].[AddressOptionList].[SortOrder].[MS_Description]...';


GO
EXECUTE sp_addextendedproperty @name = N'MS_Description', @value = N'Determines the sort order of the option list', @level0type = N'SCHEMA', @level0name = N'dbo', @level1type = N'TABLE', @level1name = N'AddressOptionList', @level2type = N'COLUMN', @level2name = N'SortOrder';


GO
PRINT N'Creating [dbo].[AddressOptionList].[IsActive].[MS_Description]...';


GO
EXECUTE sp_addextendedproperty @name = N'MS_Description', @value = N'Flag to determine if the record is active.', @level0type = N'SCHEMA', @level0name = N'dbo', @level1type = N'TABLE', @level1name = N'AddressOptionList', @level2type = N'COLUMN', @level2name = N'IsActive';


GO
PRINT N'Creating [dbo].[AddressOptionList].[StartDate].[MS_Description]...';


GO
EXECUTE sp_addextendedproperty @name = N'MS_Description', @value = N'Date when the record becomes active.', @level0type = N'SCHEMA', @level0name = N'dbo', @level1type = N'TABLE', @level1name = N'AddressOptionList', @level2type = N'COLUMN', @level2name = N'StartDate';


GO
PRINT N'Creating [dbo].[AddressOptionList].[EndDate].[MS_Description]...';


GO
EXECUTE sp_addextendedproperty @name = N'MS_Description', @value = N'End date when for the active record.', @level0type = N'SCHEMA', @level0name = N'dbo', @level1type = N'TABLE', @level1name = N'AddressOptionList', @level2type = N'COLUMN', @level2name = N'EndDate';


GO
PRINT N'Creating [dbo].[AddressOptionList].[LastChangeUser].[MS_Description]...';


GO
EXECUTE sp_addextendedproperty @name = N'MS_Description', @value = N'Last user to modify the record.', @level0type = N'SCHEMA', @level0name = N'dbo', @level1type = N'TABLE', @level1name = N'AddressOptionList', @level2type = N'COLUMN', @level2name = N'LastChangeUser';


GO
PRINT N'Creating [dbo].[AddressOptionList].[LastChangeDate].[MS_Description]...';


GO
EXECUTE sp_addextendedproperty @name = N'MS_Description', @value = N'Last change date for the record.', @level0type = N'SCHEMA', @level0name = N'dbo', @level1type = N'TABLE', @level1name = N'AddressOptionList', @level2type = N'COLUMN', @level2name = N'LastChangeDate';


GO
PRINT N'Checking existing data against newly created constraints';


GO
USE [$(DatabaseName)];


GO
ALTER TABLE [dbo].[Address] WITH CHECK CHECK CONSTRAINT [FK_Address_FormSimpleZeroId];


GO
PRINT N'Update complete.';


GO
